---
date: 2019-11-6
title: VFP
layout: post
tag: VFP
cover: https://technewskb.com/wp-content/uploads/2016/09/visualfoxpro.jpg
---

# VFP

vfp全称Visual FoxPro ，是Microsoft公司开发的数据库软件。



## 初识VFP

### 记录和字段

一行一条记录，一列一个字段

字段：即事物属性的描述

#### 字段的命名规则：

- 自由表字段名最长为10个字符
- 字段名必须以字母或汉字开头
- 字段名可以由字母、汉字、数字和下划线组成
- 字段名中不能包含空格



### 基础函数
- 求绝对值函数

  格式：`abs (<数值表达式>)`

  功能：求数值表达式的绝对值
  
- 四舍五入函数
  格式：`round （<数值表达式>,<n>）`
  功能：根据n的值对数值表达式的值进行四舍五入
  **n>0时，保留n位小数；n=0时，保留到整数位；n<0时，将小数点左边第n位进行四舍五入**
  
- 取整函数
  格式：`int(N)`
  功能：将数值表达式的计算结果只取整数部分
  
- 平方根函数
  格式：`sqrt(N)`
  功能：求数值表达式的平方根
  
- 宏替换函数
  格式：`& <字符型变量>`
  功能：用于字符型变量名前，作用即去掉分界符
  
- 子串函数
  格式：`substr(表达式，n1[,n2])`
  功能：从n1个字符开始截取到表达式中n2个字符形成一个新的子字符串。若省略n2，则截取到表达式末尾。
  注意：一个汉字占两个字符
  
- 空格生成函数
  格式：`space(N)`
  功能：生成N个空格字符串
  
- 左/右子串函数
  格式：`left/right(C,N)`
  功能：从左/右边开始截取
  
- 删除字符串尾部空格
  格式：`trim(C)`
  功能：删除字符串尾部的空格
  
- 删除字符串左/右的空格
  格式：`ltrim/rtrim(C)`
  功能：删除字符串左/右的空格
  
- 删除首尾空格
  格式：`alltrim(C)`
  功能：删除字符串首尾空格
  
- 求字符串长度
  格式：`len(<字符串表达式>)`
  功能：求字符串长度



#### 时间日期函数

- 时间函数

  格式：`time()`

  功能：获取当前系统时间

- 日期函数

  格式：`date()`

  功能：获取当前系统日期

- 年份函数

  格式：`year(<日期型表达式>)`

  功能：求取表达式内的年份

- 月份函数

  格式：`month(<日期型表达式>)`

  功能：求取表达式内的月份

- 天数函数

  格式：`day(<日期型表达式>)`

  功能：求取表达式内的天数



#### 转换函数

- 数值型转字符型

  格式：`str(N[,<长度>][,小数位数])`

  功能：将数值型数据转换为字符型数据，长度指明函数值的字符总个数

- 字符型转数值型

  格式：`val(C)`

  功能：将字符型数据转化为数值型数据





## 命令

VFP的命令基本上由命令动词和命令短语两部分组成

命令格式:`<命令动词> [<范围子句>] [<条件子句>] [<字段名表子句>]`

例如(vfp数据窗口字体大小调整)：`modify window screen font "字体名称",字号`



### 建立数据库关系

`create`:建立一个新的表

`use`:打开和关闭表文件



### 录入数据

`append`:在当前表的尾部追加记录

`insert`:在当前记录后插入

`insert before`:在当前记录前插入



### 数据库结构的显示和修改

`list/display structure`:显示数据库结构

注：`list`显示不足时直接翻页



### 修改数据库

`modify structure`:显示表文件结构，并允许修改表结构（得先打开表在使用）



### 数据库记录的显示和修改

`list/display/browse`

### 记录的定位

go 格式：`go [to] 记录位置`

### 记录的删除

delete、pack、zap、recall

作用：分别给要删除的记录作删除标记、彻底删除、删除所有记录和取消被选中的记录表的删除标记

### 字段内容的替换

格式：`replace [<范围>] <字段1> with <表达式1> [,<字段2> with <表达式2>] [for <条件>] [while <条件>]`

作用：用表达式的值代替命令中与之相对应的字段内容

### 排序

格式：`sort to <文件名> on <字段名1> [/A] [/D] [,字段名2[/A] [/D]...] [范围] [for 逻辑表达式] [fields 字段名表]`

**[/A] 升序          [/D]降序**

### 查询

格式：`locate [范围] for <条件>`

作用：在当前数据文件依次查询符合条件的第一条记录，如需向下查找使用continue



### 统计与计算

求记录个数：count [范围] [for 逻辑表达式] [to 内存变量]

求和：sum [范围] [for 逻辑表达式] [数值表达式1[,数值表达式2] to 内存变量]

求平均：average [<范围>] [for <条件>] [数值表达式1] [,数值表达式2] to 变量

分类汇总：total on <关键字段名> to <数据库文件名> [<范围>] [for <条件>] [fields 字段名表] **先排序再分类**